<font color='#af5f00'>╒ </font><font color='#d7af00'>(fcn) hook_kernel_functions</font> 153
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#5f8700'>; CALL XREF from 0x08001673 (fcn.080015a8)</font>
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#a8a8a8'>0x08000f54</font>      <font color='#d7af00'>57</font>             <font color='#875f87'>push</font><font color='#d75f00'> edi</font>                   <font color='#5f8700'> ; 0 args - hooks up to 14 kernel functions</font>
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#a8a8a8'>0x08000f55</font>      <font color='#d7af00'>56</font>             <font color='#875f87'>push</font><font color='#d75f00'> esi</font>
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#a8a8a8'>0x08000f56</font>      <font color='#d7af00'>53</font>             <font color='#875f87'>push</font><font color='#d75f00'> ebx</font>
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#a8a8a8'>0x08000f57</font>      <font color='#af5f00'>83</font><font color='#af5f00'>ec</font><font color='#af5f00'>10</font>         <font color='#a8a8a8'>sub</font><font color='#d75f00'> esp</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x10</font>
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#a8a8a8'>0x08000f5a</font>      <font color='#d7af00'>31</font><font color='#af5f00'>c0</font>           <font color='#a8a8a8'>xor</font><font color='#d75f00'> eax</font>,<font color='#d75f00'></font><font color='#d75f00'> eax</font>
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#a8a8a8'>0x08000f5c</font>      <font color='#af5f00'>c7</font><font color='#d7af00'>44</font><font color='#d7af00'>24</font><font color='#af5f00'>0c</font><font color='#875f87'>00</font><font color='#875f87'>00</font><font color='#af5f00'>.</font>  <font color='#a8a8a8'>mov dword </font>[<font color='#d75f00'>esp </font>+<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xc</font>]<font color='#d75f00'></font>,<font color='#d75f00'></font><font color='#d75f00'> 0</font>   <font color='#5f8700'> ; [ra - 0x10]</font>
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#a8a8a8'>0x08000f64</font>      <font color='#af5f00'>89</font><font color='#af5f00'>c7</font>           <font color='#a8a8a8'>mov</font><font color='#d75f00'> edi</font>,<font color='#d75f00'></font><font color='#d75f00'> eax</font>
<font color='#af5f00'>│ </font><font color='#005faf'>          </font><font color='#a8a8a8'>0x08000f66</font>      <font color='#d7af00'>31</font><font color='#af5f00'>f6</font>           <font color='#a8a8a8'>xor</font><font color='#d75f00'> esi</font>,<font color='#d75f00'></font><font color='#d75f00'> esi</font>
<font color='#af5f00'>│ </font><font color='#005faf'>      ┌─&gt; </font><font color='#a8a8a8'>0x08000f68</font>      <font color='#af5f00'>80</font><font color='#af5f00'>be</font><font color='#af5f00'>d4</font><font color='#af5f00'>03</font><font color='#875f87'>00</font><font color='#875f87'>00</font><font color='#af5f00'>.</font>  <font color='#a8a8a8'>cmp byte </font>[<font color='#d75f00'>esi </font>+<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x3d4</font>]<font color='#d75f00'></font>,<font color='#d75f00'></font><font color='#d75f00'> 0</font>  ; RELOC 32 .data
<font color='#af5f00'>│ </font><font color='#005faf'>     ┌──&lt; </font><font color='#a8a8a8'>0x08000f6f</font>      <font color='#d7af00'>75</font><font color='#af5f00'>17</font>           <font color='#5f8700'>jne 0x8000f88</font><font color='#d7af00'></font>              <font color='#5f8700'> ; hook this function?</font>
<font color='#af5f00'>│ </font><font color='#005faf'>    ┌───&gt; </font><font color='#a8a8a8'>0x08000f71</font>      <font color='#d7af00'>47</font>             <font color='#a8a8a8'>inc</font><font color='#d75f00'> edi</font>                    <font color='#5f8700'> ; advance forward</font>
<font color='#af5f00'>│ </font><font color='#005faf'>    │││   </font><font color='#a8a8a8'>0x08000f72</font>      <font color='#af5f00'>83</font><font color='#af5f00'>c6</font><font color='#af5f00'>18</font>         <font color='#a8a8a8'>add</font><font color='#d75f00'> esi</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x18</font>              <font color='#5f8700'> ; records are 0x18 bytes</font>
<font color='#af5f00'>│ </font><font color='#005faf'>    │││   </font><font color='#a8a8a8'>0x08000f75</font>      <font color='#af5f00'>83</font><font color='#af5f00'>ff</font><font color='#af5f00'>0e</font>         <font color='#a8a8a8'>cmp</font><font color='#d75f00'> edi</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xe</font>               <font color='#5f8700'> ; count to 14</font>
<font color='#af5f00'>│ </font><font color='#005faf'>    ││└─&lt; </font><font color='#a8a8a8'>0x08000f78</font>      <font color='#d7af00'>76</font><font color='#af5f00'>ee</font>           <font color='#5f8700'>jbe 0x8000f68</font><font color='#d7af00'></font>              <font color='#5f8700'> ; the end?</font>
<font color='#af5f00'>│ </font><font color='#005faf'>    ││    </font><font color='#a8a8a8'>0x08000f7a</font>      <font color='#af5f00'>89</font><font color='#af5f00'>c2</font>           <font color='#a8a8a8'>mov</font><font color='#d75f00'> edx</font>,<font color='#d75f00'></font><font color='#d75f00'> eax</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  ┌┌──┌─&gt; </font><font color='#a8a8a8'>0x08000f7c</font>      <font color='#af5f00'>83</font><font color='#af5f00'>c4</font><font color='#af5f00'>10</font>         <font color='#a8a8a8'>add</font><font color='#d75f00'> esp</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x10</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││││   </font><font color='#a8a8a8'>0x08000f7f</font>      <font color='#d7af00'>5b</font>             <font color='#875f87'>pop</font><font color='#d75f00'> ebx</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││││   </font><font color='#a8a8a8'>0x08000f80</font>      <font color='#d7af00'>5e</font>             <font color='#875f87'>pop</font><font color='#d75f00'> esi</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││││   </font><font color='#a8a8a8'>0x08000f81</font>      <font color='#af5f00'>89</font><font color='#af5f00'>d0</font>           <font color='#a8a8a8'>mov</font><font color='#d75f00'> eax</font>,<font color='#d75f00'></font><font color='#d75f00'> edx</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││││   </font><font color='#a8a8a8'>0x08000f83</font>      <font color='#d7af00'>5f</font>             <font color='#875f87'>pop</font><font color='#d75f00'> edi</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││││   </font><font color='#a8a8a8'>0x08000f84</font>      <font color='#af5f00'>c3</font>             <font color='#005faf'>ret</font>
  <font color='#005faf'>  │││││   </font><font color='#a8a8a8'>0x08000f85</font>      <font color='#af5f00'>8d</font><font color='#d7af00'>76</font><font color='#875f87'>00</font>         <font color='#a8a8a8'>lea</font><font color='#d75f00'> esi</font>,<font color='#d75f00'></font><font color='#d75f00'> </font>[<font color='#d75f00'>esi</font>]<font color='#d75f00'></font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││└──&gt; </font><font color='#a8a8a8'>0x08000f88</font>      <font color='#af5f00'>c7</font><font color='#d7af00'>44</font><font color='#d7af00'>24</font><font color='#af5f00'>0c</font><font color='#875f87'>00</font><font color='#875f87'>00</font><font color='#af5f00'>.</font>  <font color='#a8a8a8'>mov dword </font>[<font color='#d75f00'>esp </font>+<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xc</font>]<font color='#d75f00'></font>,<font color='#d75f00'></font><font color='#d75f00'> 0</font>   <font color='#5f8700'> ; [ra - 0x10]</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000f90</font>      <font color='#d7af00'>51</font>             <font color='#875f87'>push</font><font color='#d75f00'> ecx</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000f91</font>      <font color='#d7af00'>6a</font><font color='#af5f00'>05</font>           <font color='#875f87'>push</font><font color='#d75f00'> 5</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000f93</font>      <font color='#af5f00'>ff</font><font color='#af5f00'>b6</font><font color='#af5f00'>c8</font><font color='#af5f00'>03</font><font color='#875f87'>00</font><font color='#875f87'>00</font>   <font color='#875f87'>push dword </font>[<font color='#d75f00'>esi </font>+<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x3c8</font>]<font color='#d75f00'></font>  ; RELOC 32 .data<font color='#5f8700'> ; kernel function to hook</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000f99</font>      <font color='#af5f00'>8d</font><font color='#d7af00'>44</font><font color='#d7af00'>24</font><font color='#af5f00'>18</font>       <font color='#a8a8a8'>lea</font><font color='#d75f00'> eax</font>,<font color='#d75f00'> </font>[<font color='#d75f00'>esp </font>+<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x18</font>]<font color='#d75f00'></font>      <font color='#5f8700'> ; [ra - 0x10]</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000f9d</font>      <font color='#d7af00'>50</font>             <font color='#875f87'>push</font><font color='#d75f00'> eax</font>                   <font color='#5f8700'> ; outptr</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000f9e</font>      <font color='#af5f00'>a1</font><font color='#875f87'>00</font><font color='#875f87'>00</font><font color='#875f87'>00</font><font color='#875f87'>00</font>     <font color='#a8a8a8'>mov</font><font color='#d75f00'> eax</font>,<font color='#d75f00'> dword</font><font color='#d75f00'> </font>[<font color='#d75f00'>0</font>]<font color='#d75f00'></font>  ; RELOC 32 the_interface
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000fa3</font>      <font color='#af5f00'>ff</font><font color='#d7af00'>50</font><font color='#d7af00'>54</font>         <font color='#87d700'>call dword [eax + 0x54]</font>    <font color='#5f8700'> ; call core.54 is kernel function hookable?</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000fa6</font>      <font color='#af5f00'>83</font><font color='#af5f00'>c4</font><font color='#af5f00'>10</font>         <font color='#a8a8a8'>add</font><font color='#d75f00'> esp</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x10</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000fa9</font>      <font color='#af5f00'>85</font><font color='#af5f00'>c0</font>           <font color='#a8a8a8'>test</font><font color='#d75f00'> eax</font>,<font color='#d75f00'></font><font color='#d75f00'> eax</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000fab</font>      <font color='#af5f00'>8d</font><font color='#af5f00'>9e</font><font color='#af5f00'>c0</font><font color='#af5f00'>03</font><font color='#875f87'>00</font><font color='#875f87'>00</font>   <font color='#a8a8a8'>lea</font><font color='#d75f00'> ebx</font>,<font color='#d75f00'> </font>[<font color='#d75f00'>esi </font>+<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x3c0</font>]<font color='#d75f00'></font>  ; RELOC 32 .data
<font color='#af5f00'>│ </font><font color='#005faf'>  │││ │   </font><font color='#a8a8a8'>0x08000fb1</font>      <font color='#af5f00'>ba</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font>     <font color='#a8a8a8'>mov</font><font color='#d75f00'> edx</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xffffffff</font>
<font color='#af5f00'>│ </font><font color='#005faf'>  └─────&lt; </font><font color='#a8a8a8'>0x08000fb6</font>      <font color='#d7af00'>74</font><font color='#af5f00'>c4</font>           <font color='#5f8700'>je 0x8000f7c</font><font color='#d7af00'></font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││ │   </font><font color='#a8a8a8'>0x08000fb8</font>      <font color='#af5f00'>8b</font><font color='#d7af00'>54</font><font color='#d7af00'>24</font><font color='#af5f00'>0c</font>       <font color='#a8a8a8'>mov</font><font color='#d75f00'> edx</font>,<font color='#d75f00'> dword </font>[<font color='#d75f00'>esp </font>+<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xc</font>]<font color='#d75f00'></font> <font color='#5f8700'> ; [ra - 0x10]</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││ │   </font><font color='#a8a8a8'>0x08000fbc</font>      <font color='#af5f00'>85</font><font color='#af5f00'>d2</font>           <font color='#a8a8a8'>test</font><font color='#d75f00'> edx</font>,<font color='#d75f00'></font><font color='#d75f00'> edx</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││┌──&lt; </font><font color='#a8a8a8'>0x08000fbe</font>      <font color='#d7af00'>75</font><font color='#d7af00'>26</font>           <font color='#5f8700'>jne 0x8000fe6</font><font color='#d7af00'></font>              <font color='#5f8700'> ; FAIL</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fc0</font>      <font color='#af5f00'>83</font><font color='#af5f00'>ec</font><font color='#af5f00'>0c</font>         <font color='#a8a8a8'>sub</font><font color='#d75f00'> esp</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xc</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fc3</font>      <font color='#d7af00'>6a</font><font color='#875f87'>00</font>           <font color='#875f87'>push</font><font color='#d75f00'> 0</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fc5</font>      <font color='#d7af00'>50</font>             <font color='#875f87'>push</font><font color='#d75f00'> eax</font>                   <font color='#5f8700'> ; return value from core.54</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fc6</font>      <font color='#af5f00'>ff</font><font color='#d7af00'>73</font><font color='#af5f00'>0c</font>         <font color='#875f87'>push dword </font>[<font color='#d75f00'>ebx </font>+<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xc</font>]<font color='#d75f00'></font>     <font color='#5f8700'> ; local function to redirect to</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fc9</font>      <font color='#af5f00'>ff</font><font color='#d7af00'>73</font><font color='#af5f00'>08</font>         <font color='#875f87'>push dword </font>[<font color='#d75f00'>ebx </font>+<font color='#d75f00'></font><font color='#d75f00'> 8</font>]<font color='#d75f00'></font>       <font color='#5f8700'> ; kernel function to hook</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fcc</font>      <font color='#af5f00'>8d</font><font color='#d7af00'>43</font><font color='#af5f00'>04</font>         <font color='#a8a8a8'>lea</font><font color='#d75f00'> eax</font>,<font color='#d75f00'> </font>[<font color='#d75f00'>ebx </font>+<font color='#d75f00'></font><font color='#d75f00'> 4</font>]<font color='#d75f00'></font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fcf</font>      <font color='#d7af00'>50</font>             <font color='#875f87'>push</font><font color='#d75f00'> eax</font>                   <font color='#5f8700'> ; outptr</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fd0</font>      <font color='#af5f00'>a1</font><font color='#875f87'>00</font><font color='#875f87'>00</font><font color='#875f87'>00</font><font color='#875f87'>00</font>     <font color='#a8a8a8'>mov</font><font color='#d75f00'> eax</font>,<font color='#d75f00'> dword</font><font color='#d75f00'> </font>[<font color='#d75f00'>0</font>]<font color='#d75f00'></font>  ; RELOC 32 the_interface
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fd5</font>      <font color='#af5f00'>ff</font><font color='#d7af00'>50</font><font color='#d7af00'>58</font>         <font color='#87d700'>call dword [eax + 0x58]</font>    <font color='#5f8700'> ; call core.58: hook kernel function</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fd8</font>      <font color='#af5f00'>83</font><font color='#af5f00'>c4</font><font color='#d7af00'>20</font>         <font color='#a8a8a8'>add</font><font color='#d75f00'> esp</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0x20</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fdb</font>      <font color='#af5f00'>85</font><font color='#af5f00'>c0</font>           <font color='#a8a8a8'>test</font><font color='#d75f00'> eax</font>,<font color='#d75f00'></font><font color='#d75f00'> eax</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   ││││   </font><font color='#a8a8a8'>0x08000fdd</font>      <font color='#af5f00'>ba</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font>     <font color='#a8a8a8'>mov</font><font color='#d75f00'> edx</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xffffffff</font>
<font color='#af5f00'>│ </font><font color='#005faf'>   │└───&lt; </font><font color='#a8a8a8'>0x08000fe2</font>      <font color='#d7af00'>74</font><font color='#af5f00'>8d</font>           <font color='#5f8700'>je 0x8000f71</font><font color='#d7af00'></font>
<font color='#af5f00'>│ </font><font color='#005faf'>   └────&lt; </font><font color='#a8a8a8'>0x08000fe4</font>      <font color='#af5f00'>eb</font><font color='#af5f00'>96</font>           <font color='#5f8700'>jmp 0x8000f7c</font><font color='#d7af00'></font>
<font color='#af5f00'>│ </font><font color='#005faf'>     └──&gt; </font><font color='#a8a8a8'>0x08000fe6</font>      <font color='#af5f00'>ba</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font><font color='#af5f00'>ff</font>     <font color='#a8a8a8'>mov</font><font color='#d75f00'> edx</font>,<font color='#d75f00'></font><font color='#d75f00'> </font><font color='#d7af00'>0xffffffff</font>
<font color='#af5f00'>╘ </font><font color='#005faf'>      └─&lt; </font><font color='#a8a8a8'>0x08000feb</font>      <font color='#af5f00'>eb</font><font color='#af5f00'>8f</font>           <font color='#5f8700'>jmp 0x8000f7c</font><font color='#d7af00'></font>
